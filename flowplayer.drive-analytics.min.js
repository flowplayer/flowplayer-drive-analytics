/*!

   Drive analytics plugin for Flowplayer HTML5

   Copyright (c) 2016, Flowplayer Oy

   Released under the ISC License:
   https://opensource.org/licenses/ISC

*/
!function(){function e(e){var o=document.createElement("a");o.href=e;var n=["cdn.flowplayer.org","drive.flowplayer.org"],r=["cdn.dev.flowplayer.org"];return n.indexOf(o.hostname)!==-1?"https://api.flowplayer.org/events/play":r.indexOf(o.hostname)!==-1?"https://api.flowplayer.org/events/dev/play":void 0}var o=function(o){o(function(n){function r(e){e&&n.off(".drivetrack")}var t;n.on("ready",function(i,s,a){function f(o,n,r,t,i){if("number"==typeof n){var s=e(o);if(s){var a=new XMLHttpRequest;a.open("POST",s),a.setRequestHeader("Content-Type","application/json"),a.onreadystatechange=function(){a.readyState===XMLHttpRequest.DONE&&200!==a.status&&i(new Error("Request error"))},a.send(JSON.stringify({play:{src:o,seconds:n,p2pBytes:p,playerVersion:r,finished:!!t}})),p=0}}}var p=0;"undefined"!=typeof xflow&&xflow.Broker.on(xflow.Events.STATS,function(e){e.p2p&&(p+=e.loaded)}),n.one(n.conf.splash?"progress":"resume",function(){f(a.src,0,o.version,!1,r),t=5,n.on("progress.drivetrack",function(e,i,s){s<t||(f(n.video.src,t,o.version,!1,r),t+=5)}),n.on("finish.drivetrack",function(){f(n.video.src,n.video.duration,o.version,!0,r),n.one("resume",function(){f(a.src,0,o.version,!1,r),t=5})}),n.on("seek",function(e,o,n){t=5*Math.ceil(n/5)})})})})};"object"==typeof module&&module.exports?module.exports=o:"function"==typeof flowplayer&&o(flowplayer)}();